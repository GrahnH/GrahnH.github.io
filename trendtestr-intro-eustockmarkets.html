<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>trendtestr-intro-eustockmarkets</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">trendtestr-intro-eustockmarkets</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This vignette walks through a <strong>recommended automated
workflow</strong> in <strong><code>trendtestR</code></strong> using the
built-in <strong><code>EuStockMarkets</code></strong> dataset.<br />
Rather than demonstrating every function, it focuses on a <strong>small,
practical subset</strong> that covers most day-to-day use cases with
minimal manual tuning.</p>
<div id="what-youll-do-automated-path" class="section level2">
<h2>What you’ll do (automated path)</h2>
<ol style="list-style-type: decimal">
<li><p><strong>Prepare &amp; reshape data</strong> (wide → long for
grouped analysis)</p></li>
<li><p><strong>Verify time-window continuity</strong> to ensure valid
comparisons</p></li>
<li><p><strong>Compare cross-year periods</strong> at two granularities
(weekly vs daily)</p></li>
<li><p><strong>Run auto-selected group tests</strong> via
<code>run_group_test()</code> with assumptions and effect sizes</p></li>
<li><p><strong>Fit trends with one call</strong> via
<code>explore_trend_auto()</code> (automatic model family &amp;
smoothing)</p></li>
<li><p><strong>(Optional) ARIMA readiness check</strong> to decide if
time-series modeling is warranted</p></li>
</ol>
</div>
<div id="selected-functions-used" class="section level2">
<h2>Selected functions used</h2>
<ul>
<li><code>filter_by_groupcol()</code> — subset/structure data by groups
and date column<br />
</li>
<li><code>check_continuity_by_window()</code> — confirm continuous
windows across years/months</li>
<li><code>compare_monthly_cases()</code> — cross-year comparison with
chosen granularity &amp; aggregation<br />
</li>
<li><code>compare_distribution_by_granularity()</code> — sanity-check
distributional changes (day vs week)<br />
</li>
<li><code>run_group_tests()</code> — automated test selection +
assumptions + effect sizes<br />
</li>
<li><code>explore_trend_auto()</code> — automatic trend modeling
(Gaussian/Gamma, splines)<br />
</li>
<li><code>check_rate_diff_arima_ready()</code> <em>(optional)</em> —
stationarity, seasonality &amp; differencing hints</li>
</ul>
</div>
<div id="dataset" class="section level2">
<h2>Dataset</h2>
<p><strong><code>EuStockMarkets</code></strong> contains daily closing
prices for four European stock indices (<strong>DAX</strong>,
<strong>SMI</strong>, <strong>CAC</strong>, <strong>FTSE</strong>) from
1991-01-01 to 1996-02-03.<br />
For clarity and speed, this vignette focuses on <strong>DAX</strong> and
<strong>CAC</strong> and a <strong>two-year cross-year
window</strong>.</p>
</div>
</div>
<div id="workflow" class="section level1">
<h1>Workflow</h1>
<div id="installation-and-setup" class="section level2">
<h2>1. Installation and Setup</h2>
<p>This section loads the necessary packages and prepares the built-in
dataset <strong><code>EuStockMarkets</code></strong> for analysis.</p>
<p>We will: - Convert the built-in time-series object to a
<strong>data.frame</strong> with an explicit <strong>date</strong>
column. - Reshape it from <strong>wide format</strong> (one column per
market) to <strong>long format</strong> (one column for market names,
one for index values), which is easier to group, filter, and visualize
in <strong><code>trendtestR</code></strong> workflows.</p>
</div>
<div id="load-required-packages" class="section level2">
<h2>1.1 Load required packages</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(trendtestR)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code></pre></div>
</div>
<div id="data-preparation" class="section level2">
<h2>1.2 Data Preparation</h2>
<p>The built-in dataset contains daily closing prices of four European
stock market indices: DAX (Germany), SMI (Switzerland), CAC (France),
and FTSE (UK), covering the period 1991-01-01 to 1996-02-03.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Load the built-in dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;EuStockMarkets&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Create a dataframe with a date column and the stock indices</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>eu_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">&quot;1991-01-01&quot;</span>), <span class="at">by =</span> <span class="st">&quot;day&quot;</span>, <span class="at">length.out =</span> <span class="fu">nrow</span>(EuStockMarkets)),</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(EuStockMarkets)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co"># Preview the last few rows</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="fu">tail</span>(eu_df)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co"># Reshape the dataset to long format for easier grouping and filterin</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>eu_long <span class="ot">&lt;-</span> eu_df <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(DAX, SMI, CAC, FTSE),</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;market&quot;</span>,</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;index&quot;</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">market =</span> <span class="fu">factor</span>(market))</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co"># Preview the first few rows</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="fu">head</span>(eu_long)</span></code></pre></div>
</div>
<div id="data-filtering" class="section level2">
<h2>2. Data Filtering</h2>
<p>We keep only <strong>DAX</strong> (Germany) and <strong>CAC</strong>
(France) for a smaller, faster analysis.<br />
<strong><code>filter_by_groupcol()</code></strong> lets us select
specific groups while keeping the data in long format.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ecoDaxCac <span class="ot">&lt;-</span> <span class="fu">filter_by_groupcol</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  eu_long,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">group_col =</span> <span class="st">&quot;market&quot;</span>,    <span class="co"># grouping variable</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">value_col =</span> <span class="st">&quot;index&quot;</span>,     <span class="co"># values to analyze</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">datum_col =</span> <span class="st">&quot;date&quot;</span>,      <span class="co"># date variable</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">keep_levels =</span> <span class="fu">c</span>(<span class="st">&quot;DAX&quot;</span>, <span class="st">&quot;CAC&quot;</span>),</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">to_wide =</span> <span class="cn">FALSE</span>,         </span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="at">keep_other_cols =</span> <span class="cn">TRUE</span>   </span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co"># Preview the first few rows</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="fu">head</span>(ecoDaxCac)</span></code></pre></div>
</div>
<div id="data-continuity-check" class="section level2">
<h2>3. Data Continuity Check</h2>
<p>We use <strong><code>check_continuity_by_window()</code></strong> to
verify there are no date gaps in the selected period, ensuring data
quality before running further functions.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>checkconti <span class="ot">&lt;-</span> <span class="fu">check_continuity_by_window</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">date_vec =</span> ecoDaxCac<span class="sc">$</span>date,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="dv">1993</span>),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">months =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">9</span>), </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">window_unit =</span> <span class="st">&quot;day&quot;</span>, </span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">use_isoweek =</span> <span class="cn">TRUE</span>, </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="at">allow_leading_gap =</span> <span class="cn">TRUE</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co"># Display continuity results</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Data is continuous:&quot;</span>, checkconti<span class="sc">$</span>continuous, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Data range:&quot;</span>, <span class="fu">as.character</span>(checkconti<span class="sc">$</span>range), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co"># Output: Data is continuous: TRUE </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co"># Output: Data range: 1991-10-01 1993-09-30</span></span></code></pre></div>
</div>
<div id="cross-year-data-comparison" class="section level2">
<h2>4. Cross-Year Data Comparison</h2>
<p>We use <strong><code>compare_monthly_cases()</code></strong> to
compare values between years over a cross-year period, allowing flexible
month selection and time aggregation.</p>
</div>
<div id="weekly-granularity-comparison" class="section level2">
<h2>4.1 Weekly Granularity Comparison</h2>
<p>We first compare 1992–1993 data aggregated weekly:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Compare 1992-1993 data with weekly granularity</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>reseuro <span class="ot">&lt;-</span> <span class="fu">compare_monthly_cases</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  ecoDaxCac, </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">datum_col =</span> <span class="st">&quot;date&quot;</span>, </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">value_col =</span> <span class="st">&quot;index&quot;</span>, </span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">group_col =</span> <span class="st">&quot;market&quot;</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">1993</span>),</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="at">months =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>), <span class="co"># Oct–Dec + Jan–Sep (cross-year)</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="at">granularity =</span> <span class="st">&quot;week&quot;</span>,    </span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="at">agg_fun =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="at">shift_month =</span> <span class="st">&quot;mth_to_next&quot;</span> <span class="co">#alternative param: mth_to_prev, none </span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co"># Note: Function automatically excludes groups with no data (1991, 1995)</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co"># Shows standardization info and data characteristics</span></span></code></pre></div>
</div>
<div id="daily-granularity-comparison" class="section level2">
<h2>4.2 Daily Granularity Comparison</h2>
<p>We repeat the analysis at daily granularity to compare results:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Compare same period with daily granularity</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>reseurod <span class="ot">&lt;-</span> <span class="fu">compare_monthly_cases</span>(</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  ecoDaxCac, </span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">datum_col =</span> <span class="st">&quot;date&quot;</span>, </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">value_col =</span> <span class="st">&quot;index&quot;</span>, </span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">group_col =</span> <span class="st">&quot;market&quot;</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">1993</span>),</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="at">months =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>),</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="at">granularity =</span> <span class="st">&quot;day&quot;</span>,    </span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="at">agg_fun =</span> <span class="st">&quot;median&quot;</span>,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="at">shift_month =</span> <span class="st">&quot;mth_to_next&quot;</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co"># View statistical test results</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="fu">print</span>(reseuro<span class="sc">$</span>tests)</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co"># Results show Kruskal-Wallis test with large effect size (eta² ≈ 0.31)</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co"># Includes assumption checks and post-hoc Dunn tests</span></span></code></pre></div>
</div>
<div id="distribution-comparison-across-granularities" class="section level2">
<h2>4.3 Distribution Comparison Across Granularities</h2>
<p>We then compare distributions between granularities to guide
aggregation choice:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Compare distributions using Q-Q plots</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">compare_distribution_by_granularity</span>(reseuro, reseurod)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#Shows normality tests and variance tests for different granularities</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#Helps determine optimal time aggregation level</span></span></code></pre></div>
<p>This helps determine the most suitable time aggregation level for
subsequent statistical analyses.</p>
</div>
<div id="automated-statistical-testing" class="section level2">
<h2>5. Automated Statistical Testing</h2>
<p>We use <strong><code>run_group_tests()</code></strong> to
automatically select and perform the most appropriate statistical test
based on data characteristics, including assumption checks and effect
size calculation.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Run automated group comparison tests</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> <span class="fu">run_group_tests</span>(</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  reseuro<span class="sc">$</span>data, </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">value_col =</span> <span class="st">&quot;index&quot;</span>, </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">group_col =</span> <span class="st">&quot;market&quot;</span>,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="at">effect_size =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="at">report_assumptions =</span> <span class="cn">TRUE</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="fu">print</span>(test_results)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co"># Function automatically excludes groups with no data (FTSE, SMI)</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co"># Recommends Mann-Whitney U-Test due to violated normality assumptions</span></span></code></pre></div>
</div>
<div id="trend-modeling" class="section level2">
<h2>6. Trend Modeling</h2>
<p>We start with <strong>automatic model selection</strong> using
<strong><code>explore_trend_auto()</code></strong>, which evaluates
multiple candidate families (e.g., Gaussian, Gamma, Poisson, ZINB) and
chooses the most suitable one based on AIC and model diagnostics.</p>
<p>This step provides a quick, data-driven baseline model before
fine-tuning parameters such as spline degrees of freedom in the next
section.</p>
</div>
<div id="automated-trend-exploration" class="section level2">
<h2>6.1 Automated Trend Exploration</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Automatically select the most appropriate trend model</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>trend_auto <span class="ot">&lt;-</span> <span class="fu">explore_trend_auto</span>(</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  reseuro<span class="sc">$</span>data, </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="at">datum_col =</span> <span class="st">&quot;date&quot;</span>, </span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="at">value_col =</span> <span class="st">&quot;.value&quot;</span>, </span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="at">group_col =</span> <span class="st">&quot;market&quot;</span>,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;auto&quot;</span>, </span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="at">kdf =</span> <span class="dv">5</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="fu">print</span>(trend_auto<span class="sc">$</span>summary)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co"># Function compares Gaussian vs Gamma GLM and selects optimal model</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co"># Shows AIC comparison and model selection rationale</span></span></code></pre></div>
</div>
<div id="spline-degrees-of-freedom-optimization" class="section level2">
<h2>6.2 Spline Degrees of Freedom Optimization</h2>
<p>While <strong><code>explore_trend_auto()</code></strong> already
selects a reasonable default, users may wish to <strong>manually
fine-tune model complexity</strong> for deeper exploration.</p>
<p>Here we illustrate one such approach: selecting spline degrees of
freedom based on the <strong>largest AIC drop</strong> compared to the
previous candidate, rather than simply picking the absolute AIC
minimum.<br />
This captures the point of <strong>maximum improvement before
diminishing returns</strong>.</p>
<blockquote>
<p>This is just <strong>one possible workflow</strong> — any of the
<code>explore_*_trend()</code> functions can be used interactively to
test different model families, spline settings, or grouping structures
for more tailored analysis.</p>
</blockquote>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Create AIC comparison dataframe</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>aic_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">df_spline =</span> <span class="fu">integer</span>(),</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">numeric</span>()</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co"># Loop through different degrees of freedom</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="cf">for</span> (df <span class="cf">in</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>) {</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">explore_continuous_trend</span>(</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>    reseuro<span class="sc">$</span>data, </span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>    <span class="at">datum_col =</span> <span class="st">&quot;date&quot;</span>, </span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>    <span class="at">value_col =</span> <span class="st">&quot;.value&quot;</span>, </span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>    <span class="at">group_col =</span> <span class="st">&quot;market&quot;</span>,</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,  </span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>    <span class="at">df_spline =</span> df</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>  )</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>  aic_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(aic_df, <span class="fu">data.frame</span>(<span class="at">df_spline =</span> df, <span class="at">AIC =</span> <span class="fu">AIC</span>(tmp<span class="sc">$</span>model)))</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>}</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co"># Find optimal degrees of freedom</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>aic_drop <span class="ot">&lt;-</span> <span class="fu">diff</span>(aic_df<span class="sc">$</span>AIC)</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>optimal_df <span class="ot">&lt;-</span> aic_df<span class="sc">$</span>df_spline[<span class="fu">which.max</span>(<span class="sc">-</span>aic_drop)] <span class="sc">+</span> <span class="dv">1</span> <span class="co"># largest negative drop</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;optimal spline degrees of freedom:&quot;</span>, optimal_df, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="modeling-with-optimal-parameters" class="section level2">
<h2>6.3 Modeling with Optimal Parameters</h2>
<p>We refit the trend model using the <strong>optimal spline degrees of
freedom</strong> found above, ensuring the model complexity is justified
by the largest improvement in fit.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>euexp <span class="ot">&lt;-</span> <span class="fu">explore_continuous_trend</span>(</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  reseuro<span class="sc">$</span>data, </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="at">datum_col =</span> <span class="st">&quot;date&quot;</span>, </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="at">value_col =</span> <span class="st">&quot;.value&quot;</span>, </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="at">group_col =</span> <span class="st">&quot;market&quot;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="at">df_spline =</span> optimal_df  <span class="co"># Use df=5 for optimal fit</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co"># View model summary</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="fu">summary</span>(euexp<span class="sc">$</span>model)</span></code></pre></div>
</div>
<div id="model-diagnostics" class="section level2">
<h2>7. Model Diagnostics</h2>
<p>After fitting the trend model, we run
<strong><code>diagnose_model_trend()</code></strong> to check whether
model assumptions are met. This step validates residual behavior, tests
for normality and variance homogeneity, and helps decide if further
model adjustments are necessary.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Perform model diagnostics</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>diagnosis <span class="ot">&lt;-</span> <span class="fu">diagnose_model_trend</span>(euexp<span class="sc">$</span>model)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># Provides residual plots, normality tests, and homogeneity checks</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># Includes Kolmogorov-Smirnov, Shapiro-Wilk, and Levene tests</span></span></code></pre></div>
</div>
<div id="arima-modeling-preparation" class="section level2">
<h2>8. ARIMA Modeling Preparation</h2>
<p>Before applying ARIMA, we run
<strong><code>check_rate_diff_arima_ready()</code></strong> to assess if
the data meets key time-series assumptions. This step checks for
outliers, trend and seasonality patterns, and suggests whether
differencing is required, ensuring a more stable ARIMA fit.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Pre-ARIMA modeling checks</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>arima_check <span class="ot">&lt;-</span> <span class="fu">check_rate_diff_arima_ready</span>(</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="at">rate_diff_vec =</span> eu_df<span class="sc">$</span>DAX,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="at">date_vec =</span> eu_df<span class="sc">$</span>date,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="at">frequency =</span> <span class="dv">52</span>,</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="at">plot_acf =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="at">do_stl =</span> <span class="cn">TRUE</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co"># Shows comprehensive analysis: outliers, stationarity tests, </span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co"># seasonal decomposition, and differencing recommendations</span></span></code></pre></div>
</div>
<div id="other-functions-at-a-glance" class="section level2">
<h2>Other Functions (at a glance)</h2>
<p>We also provide utilities beyond this recommended workflow.</p>
<div id="epidemiology-style-weekly-visualization" class="section level3">
<h3>Epidemiology-style weekly visualization</h3>
<ul>
<li><code>plot_weekly_cases()</code> — weekly aggregation and
visualization for epi data.
<ul>
<li>Aggregates by ISO week with user-defined retrospective windows
(single range or custom start–end).</li>
<li>Generates three plot types: trend (bar+line), histogram with
density, and boxplot.</li>
<li>Supports flexible aggregation functions (<code>sum</code>,
<code>mean</code>, etc.) and optional plot selection.</li>
<li>Calculates and reports 95% confidence intervals for weekly
means.</li>
<li>Allows saving plots to file, making it suitable for seasonality
checks, outbreak monitoring, and reporting-ready outputs.</li>
</ul></li>
</ul>
</div>
<div id="additional-statistical-testing" class="section level3">
<h3>Additional statistical testing</h3>
<ul>
<li><code>run_group_tests()</code> — (used above) auto-selects tests +
assumptions + effect sizes.</li>
<li><code>run_paired_tests()</code> — paired or unpaired comparisons
with normality checks and nonparametric fallback.</li>
<li><code>run_multi_group_tests()</code> — k-group comparisons (ANOVA /
Kruskal–Wallis) with optional post-hoc (Tukey / Dunn).</li>
<li><code>run_count_two_group_tests()</code> — compares count data
between two groups, automatically chooses Poisson or Negative Binomial
regression <strong>based on overdispersion</strong>.</li>
<li><code>run_count_multi_group_tests()</code> — compares count data
across ≥3 groups, automatically chooses Poisson vs Negative Binomial
<strong>based on overdispersion</strong>, reports an overall
(ANOVA-like) p-value and, if significant, <strong>post-hoc</strong>
pairwise results; optional effect size (McFadden pseudo-R²) and basic
assumption diagnostics.</li>
</ul>
</div>
<div id="additional-trend-modeling" class="section level3">
<h3>Additional trend modeling</h3>
<ul>
<li><code>explore_continuous_trend()</code> — GLM-style trends for
continuous outcomes (Gaussian/Gamma), with spline control.</li>
<li><code>explore_poisson_trend()</code> — GAM-style trends for
count-data (Poisson / Negative Binomial) with spline control.</li>
<li><code>explore_zinb_trend()</code> — zero-inflated counts (ZIP vs
ZINB) with AIC/Vuong comparison.</li>
<li><code>explore_trend_auto()</code> — (used above) single-entry auto
dispatcher choosing a suitable family and functions.</li>
</ul>
</div>
<div id="time-series-readiness" class="section level3">
<h3>Time-series readiness</h3>
<ul>
<li><code>check_rate_diff_arima_ready()</code> — (used above)
stationarity, STL seasonality, differencing and ACF diagnostics before
ARIMA.</li>
</ul>
<blockquote>
<p>These functions can be combined with the same data-prep pattern (wide
→ long, filtered groups, verified continuity). Pick what you need: quick
epi weekly plots, richer hypothesis tests, or specialized trend families
for counts and zero-inflated data.</p>
</blockquote>
</div>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>This vignette walked through a <strong>streamlined, automated
workflow</strong> in <code>trendtestR</code> using the built-in
<code>EuStockMarkets</code> dataset.<br />
We started with <strong>data preparation and continuity checks</strong>,
moved through <strong>cross-year comparisons</strong>,
<strong>auto-selected statistical testing</strong>, and
<strong>automatic trend modeling</strong>, and optionally ran
<strong>ARIMA readiness checks</strong> for time-series forecasting.</p>
<p>Beyond this workflow, <code>trendtestR</code> provides
<strong>modular functions</strong> for epidemiology-style weekly plots,
overdispersion-aware count-data testing, and specialized trend models
for continuous, count, or zero-inflated data.<br />
You can adopt the full automated path for rapid insights, or <strong>mix
and match components</strong> for deeper, more customized analyses — all
while keeping a consistent data-preparation pattern and diagnostic
rigor.</p>
<p>For detailed functionality, please refer to the help documentation of
individual functions.</p>
<p><strong>Example use cases include</strong>:</p>
<ul>
<li>Financial time series analysis: stock prices, market indices,
trading volumes<br />
</li>
<li>Economic data analysis: GDP growth, inflation rates, employment
figures<br />
</li>
<li>Epidemiological studies: disease incidence rates, vaccination
coverage<br />
</li>
<li>Environmental monitoring: temperature trends, pollution levels,
rainfall patterns<br />
</li>
<li>Business analytics: sales trends, customer metrics, operational
KPIs</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
